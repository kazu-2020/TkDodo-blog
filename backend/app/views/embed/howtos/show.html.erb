<% content_for(:title, @howto_data[:name]) %>

<div
  class="embed rounded-sm shadow-md text-white bg-gray-750 border border-gray-450"
>
  <a href="<%= "https://www.nhk.jp/p/gc/ts/#{@episode_data.dig(:identifierGroup, :seriesId)}/howto/#{@howto_data[:id]}" %>" target="_blank">
    <div class="p-3 grid grid-cols-12 gap-3">
      <div class="col-span-7">
        <div>
          <span class="text-xs" style="color: <%= @episode_data.dig(:partOfSeries, :style, :primaryLight) %>"><%= @episode_data.dig(:identifierGroup, :seriesName) %></span>
          <span class="text-gray-350 text-xs"><%= @episode_data[:name] %></span>
        </div>
        <div class="font-bold text-lg mt-1 mb-2"><%= @howto_data[:name] %></div>
        <div class="text-gray-350 text-sm">
          <%= @howto_data[:description] %>
        </div>
      </div>
      <div class="col-span-5 pl-4">
        <img
          decoding="async"
          src="<%= @howto_data.dig(:image, :medium, :url) %>"
          data-v-7e59b65e=""
          class="rounded-sm"
          />
      </div>

      <div class="steps col-span-12">
        <% @howto_data[:section].each do |section| %>
          <div
            class="col-span-12 border-t border-gray-350 pt-2"
          >
            <div class="flex font-bold mb-2">
              <span class="material-icons">
                format_list_numbered
              </span>
              <span class="ml-3"><%= section[:name] %></span>
            </div>
            <ol class="list-decimal list-inside text-gray-350">
              <% section[:step].take(3).each do |step| %>
                <li class="mb-1">
                  <span class="ml-1"><%= step[:name] %></span>
                </li>
              <% end %>
            </ol>
          </div>
        <% end %>
      </div>
    </div>
    <%= render 'shared/embed_footer' %>
  </a>
</div>

<% content_for(:style) do %>
  <style>
      .steps {
          max-height: 300px;
          overflow: scroll;
      }

      .steps ol {
          counter-reset: step-counter;
          list-style: none;
          padding: 0;
          margin: 0;
      }

      .steps li {
          font-size: 16px;
          line-height: 1.5;
          padding-left: 30px;
          position: relative;
      }

      .steps li::before {
          content: counter(step-counter);
          counter-increment: step-counter;
          background-color: #fff;
          border: 1px solid;
          border-radius: 50%;
          box-sizing: border-box;
          display: flex;
          justify-content: center;
          align-items: center;
          height: 22px;
          width: 22px;
          color: #333;
          font-size: 85%;
          line-height: 1;
          position: absolute;
          top: 0;
          left: 0;
      }
  </style>
<% end %>
